<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>수학 퀴즈</title>
  <style>
    body {
      font-family: 'Arial', sans-serif;
      text-align: center;
      margin-top: 80px;
      font-size: 36px;
    }
    #korean {
      margin-top: 20px;
      font-size: 28px;
      color: #444;
    }
    button {
      font-size: 26px;
      padding: 10px 25px;
      margin-top: 30px;
      margin-right: 10px;
    }
  </style>
</head>
<body>

  <div id="question">문제를 불러오는 중...</div>
  <div id="korean"></div>
  <button onclick="generateQuestion()">다음 문제</button>
  <button onclick="speakKorean()">🔊 읽어주기</button>

  <script>
    function getRandomInt(min, max) {
      return Math.floor(Math.random() * (max - min + 1)) + min;
    }

    const numberToKorean = (num) => {
      const digits = ["", "일", "이", "삼", "사", "오", "육", "칠", "팔", "구"];
      const units = ["", "십", "백", "천", "만"];
      if (num === 0) return "영";
      let result = "";
      const str = num.toString();
      const len = str.length;
      for (let i = 0; i < len; i++) {
        const digit = parseInt(str[i]);
        const pos = len - i - 1;
        if (digit !== 0) {
          result += (digit === 1 && pos > 0 ? "" : digits[digit]) + units[pos];
        }
      }
      return result;
    };

    const opToKorean = {
      "+": "더하기",
      "-": "빼기",
      "×": "곱하기",
      "÷": "나누기"
    };

    let currentKoreanText = "";

    function generateQuestion() {
      const type = getRandomInt(1, 4); // 1: +, 2: -, 3: ×, 4: ÷
      let a, b, question = "", text = "", op = "";

      if (type === 1) {
        a = getRandomInt(0, 10000);
        b = getRandomInt(0, 10000);
        op = "+";
      } else if (type === 2) {
        a = getRandomInt(0, 10000);
        b = getRandomInt(0, a);
        op = "-";
      } else if (type === 3) {
        a = getRandomInt(1, 9);
        b = getRandomInt(1, 9);
        op = "×";
      } else {
        b = getRandomInt(1, 9);
        const result = getRandomInt(1, 9);
        a = b * result;
        op = "÷";
      }

      // Dạng số
      question = `${a} ${op} ${b} = ?`;

      // Dạng Hàn
      const koreanA = numberToKorean(a);
      const koreanB = numberToKorean(b);
      const koreanOp = opToKorean[op];
      text = `${koreanA} ${koreanOp} ${koreanB} 는 무엇입니까?`;

      // Hiển thị
      document.getElementById("question").textContent = question;
      document.getElementById("korean").textContent = text;

      // Lưu để đọc
      currentKoreanText = text;
    }

    function speakKorean() {
      const utterance = new SpeechSynthesisUtterance(currentKoreanText);
      utterance.lang = "ko-KR";

      // Nếu trình duyệt hỗ trợ, chọn giọng Hàn
      const voices = speechSynthesis.getVoices();
      const koreanVoice = voices.find(voice => voice.lang === 'ko-KR');
      if (koreanVoice) {
        utterance.voice = koreanVoice;
      }

      speechSynthesis.speak(utterance);
    }

    // Khởi tạo
    window.onload = () => {
      // Một số trình duyệt cần load voice trước
      speechSynthesis.onvoiceschanged = () => {};
      generateQuestion();
    };
  </script>

</body>
</html>
